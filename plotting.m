
close all;
%% 
volta = 8181 ;
t = [0.004, 0.017, 0.028, 0.039, 0.05, 0.063, 0.074, 0.085, 0.09699999999999999, 0.109, 0.121, 0.134, 0.145, 0.156, 0.168, 0.179, 0.191, 0.203, 0.214, 0.226, 0.238, 0.25, 0.262, 0.274, 0.285, 0.296, 0.307, 0.318, 0.33, 0.341, 0.354, 0.365, 0.376, 0.388, 0.401, 0.414, 0.425, 0.436, 0.447, 0.459, 0.473, 0.485, 0.496, 0.51, 0.523, 0.534, 0.5460000000000001, 0.557, 0.568, 0.58, 0.591, 0.6029999999999999, 0.614, 0.626, 0.638, 0.65, 0.662, 0.674, 0.6850000000000001, 0.6959999999999999, 0.708, 0.719, 0.731, 0.743, 0.755, 0.767, 0.778, 0.79, 0.8030000000000001, 0.8139999999999999, 0.826, 0.8369999999999999, 0.848, 0.86, 0.873, 0.884, 0.8960000000000001, 0.91, 0.923, 0.934, 0.9549999999999999, 0.966, 0.977, 0.9890000000000001, 1.0, 1.014, 1.026, 1.037, 1.049, 1.063, 1.074, 1.085, 1.096, 1.108, 1.119, 1.131, 1.144, 1.155, 1.166, 1.178, 1.189, 1.2, 1.214, 1.226, 1.237, 1.249, 1.26, 1.274, 1.285, 1.296, 1.307, 1.319, 1.33, 1.342, 1.354, 1.365, 1.376, 1.387, 1.399, 1.411, 1.424, 1.436, 1.447, 1.459, 1.47, 1.483, 1.494, 1.505, 1.516, 1.538, 1.55, 1.563, 1.574, 1.586, 1.597, 1.608, 1.62, 1.631, 1.643, 1.655, 1.666, 1.678, 1.691, 1.704, 1.716, 1.727, 1.739, 1.75, 1.763, 1.775, 1.786, 1.797, 1.809, 1.822, 1.835, 1.846, 1.857, 1.869, 1.88, 1.891, 1.903, 1.915, 1.926, 1.937, 1.949, 1.963, 1.974, 1.985, 1.996, 2.008, 2.019, 2.03, 2.043, 2.055, 2.066, 2.08, 2.095, 2.106, 2.117, 2.128, 2.139, 2.151, 2.163, 2.174, 2.186, 2.197, 2.21, 2.222, 2.234, 2.245, 2.256, 2.267, 2.279, 2.29, 2.303, 2.314, 2.326, 2.337, 2.349, 2.361, 2.374, 2.385, 2.397, 2.408, 2.419, 2.431, 2.444, 2.455, 2.466, 2.478, 2.49, 2.501, 2.514, 2.525, 2.546, 2.557, 2.569, 2.58, 2.591, 2.604, 2.616, 2.627, 2.638, 2.65, 2.661, 2.673, 2.685, 2.696, 2.707, 2.718, 2.733, 2.745, 2.756, 2.768, 2.779, 2.79, 2.803, 2.814, 2.826, 2.837, 2.848, 2.86, 2.877, 2.889, 2.9, 2.911, 2.924, 2.939, 2.95, 2.963, 2.974, 2.986, 2.998, 3.01, 3.021, 3.034, 3.045, 3.057, 3.069, 3.08, 3.091, 3.104, 3.115, 3.127, 3.138, 3.15, 3.162, 3.174, 3.185, 3.197, 3.208, 3.219, 3.23, 3.244, 3.255, 3.267, 3.278, 3.29, 3.303, 3.315, 3.326, 3.337, 3.349, 3.36, 3.371, 3.384, 3.396, 3.407, 3.418, 3.43, 3.442, 3.455, 3.466, 3.478, 3.49, 3.502, 3.514, 3.526, 3.54, 3.554, 3.565, 3.576, 3.588, 3.6, 3.611, 3.624, 3.635, 3.647, 3.659, 3.67, 3.684, 3.695, 3.707, 3.719, 3.73, 3.741, 3.754, 3.766, 3.777, 3.789, 3.801, 3.813, 3.825, 3.836, 3.847, 3.858, 3.869, 3.881, 3.893, 3.905, 3.916, 3.927, 3.939, 3.951, 3.964, 3.975, 3.986, 3.997, 4.009, 4.02, 4.034, 4.045, 4.057, 4.068, 4.079, 4.09, 4.104, 4.115, 4.126, 4.137, 4.149, 4.161, 4.174, 4.186, 4.197, 4.208, 4.22, 4.233, 4.244, 4.256, 4.267, 4.279, 4.29, 4.304, 4.315, 4.327, 4.338, 4.349, 4.36, 4.372, 4.384, 4.395, 4.406, 4.42, 4.434, 4.445, 4.457, 4.468, 4.483, 4.494, 4.505, 4.517, 4.528, 4.539, 4.553, 4.568, 4.579, 4.59, 4.605, 4.616, 4.627, 4.638, 4.65, 4.663, 4.675, 4.686, 4.698, 4.709, 4.721, 4.733, 4.745, 4.756, 4.767, 4.778, 4.79, 4.801, 4.814, 4.827, 4.839, 4.85, 4.861, 4.873, 4.886, 4.898, 4.909, 4.921, 4.933, 4.945, 4.956, 4.967, 4.979, 4.99, 5.003, 5.015, 5.026, 5.037, 5.048, 5.06, 5.074, 5.086, 5.097, 5.108, 5.12, 5.132, 5.144, 5.156, 5.167, 5.178, 5.189, 5.201, 5.214, 5.225, 5.237, 5.248, 5.259, 5.27, 5.285, 5.296, 5.307, 5.319, 5.331, 5.344, 5.356, 5.367, 5.378, 5.389, 5.4, 5.413, 5.425, 5.437, 5.448, 5.46, 5.473, 5.484, 5.495, 5.506, 5.518, 5.53, 5.541, 5.553, 5.565, 5.576, 5.591, 5.607, 5.618, 5.629, 5.64, 5.653, 5.664, 5.675, 5.686, 5.698, 5.709, 5.721, 5.734, 5.745, 5.756, 5.768, 5.779, 5.792, 5.804, 5.815, 5.826, 5.838, 5.85, 5.864, 5.875, 5.886, 5.897, 5.909, 5.92, 5.933, 5.946, 5.957, 5.969, 5.98, 5.994, 6.005, 6.017, 6.028, 6.039, 6.05, 6.063, 6.075, 6.087, 6.103, 6.115, 6.127, 6.138, 6.15, 6.161, 6.174, 6.185, 6.196, 6.207, 6.219, 6.23, 6.246, 6.257, 6.269, 6.28, 6.291, 6.303, 6.314, 6.326, 6.337, 6.348, 6.359, 6.372, 6.384, 6.395, 6.407, 6.418, 6.429, 6.441, 6.453, 6.465, 6.476, 6.487, 6.499, 6.513, 6.524, 6.535, 6.547, 6.558, 6.569, 6.581, 6.593, 6.609, 6.621, 6.634, 6.646, 6.657, 6.668, 6.68, 6.691, 6.703, 6.715, 6.726, 6.737, 6.748, 6.76, 6.774, 6.785, 6.797, 6.808, 6.82, 6.832, 6.844, 6.856, 6.868, 6.879, 6.891, 6.904, 6.916, 6.927, 6.938, 6.949, 6.961, 6.973, 6.984, 6.996, 7.007, 7.019, 7.033, 7.045, 7.056, 7.067, 7.079, 7.09, 7.101, 7.114, 7.126, 7.137, 7.148, 7.16, 7.171, 7.183, 7.194, 7.206, 7.217, 7.228, 7.24, 7.251, 7.264, 7.276, 7.288, 7.3, 7.313, 7.324, 7.335, 7.347, 7.359, 7.37, 7.382, 7.394, 7.406, 7.417, 7.429, 7.441, 7.453, 7.464, 7.475, 7.487, 7.498, 7.509, 7.52, 7.534, 7.545, 7.557, 7.568, 7.58, 7.593, 7.604, 7.619, 7.633, 7.644, 7.655, 7.667, 7.679, 7.691, 7.703, 7.714, 7.726, 7.737, 7.748, 7.759, 7.771, 7.783, 7.795, 7.807, 7.819, 7.83, 7.844, 7.855, 7.866, 7.877, 7.889, 7.9, 7.913, 7.925, 7.947, 7.961, 7.973, 7.985, 7.996, 8.007, 8.019, 8.031000000000001, 8.044, 8.055, 8.066000000000001, 8.077999999999999, 8.09, 8.103, 8.114000000000001, 8.125999999999999, 8.137, 8.148999999999999, 8.16, 8.170999999999999, 8.185, 8.196, 8.208, 8.220000000000001, 8.233000000000001, 8.244, 8.255000000000001, 8.266, 8.278, 8.289, 8.300000000000001, 8.313000000000001, 8.327, 8.337999999999999, 8.35, 8.363, 8.374000000000001, 8.385999999999999, 8.397, 8.407999999999999, 8.419, 8.433, 8.445, 8.459, 8.476000000000001, 8.487, 8.504, 8.516, 8.526999999999999, 8.538, 8.548999999999999, 8.56, 8.571999999999999, 8.585000000000001, 8.596, 8.608000000000001, 8.619999999999999, 8.634, 8.645, 8.656000000000001, 8.667, 8.679, 8.69, 8.702999999999999, 8.714, 8.726000000000001, 8.738, 8.75, 8.760999999999999, 8.773, 8.785, 8.795999999999999, 8.807, 8.819000000000001, 8.83, 8.840999999999999, 8.853, 8.865, 8.877000000000001, 8.888, 8.907, 8.917999999999999, 8.929, 8.941000000000001, 8.952999999999999, 8.964, 8.975, 8.989000000000001, 9.0, 9.012, 9.023999999999999, 9.035, 9.045999999999999, 9.057, 9.069000000000001, 9.08, 9.093, 9.105, 9.116, 9.128, 9.141, 9.153, 9.164999999999999, 9.176, 9.186999999999999, 9.198, 9.209, 9.221, 9.233000000000001, 9.244999999999999, 9.256, 9.268000000000001, 9.279999999999999, 9.297000000000001, 9.308, 9.319000000000001, 9.33, 9.345000000000001, 9.356, 9.367000000000001, 9.379, 9.390000000000001, 9.404, 9.414999999999999, 9.426, 9.436999999999999, 9.449, 9.460000000000001, 9.471, 9.483000000000001, 9.494, 9.506, 9.519, 9.532999999999999, 9.544, 9.555, 9.567, 9.577999999999999, 9.589, 9.601000000000001, 9.613, 9.624000000000001, 9.641, 9.657, 9.669, 9.68, 9.696999999999999, 9.708, 9.718999999999999, 9.731, 9.744, 9.755000000000001, 9.766, 9.778, 9.789999999999999, 9.804, 9.816000000000001, 9.827, 9.839, 9.85, 9.864000000000001, 9.875999999999999, 9.887, 9.898, 9.909000000000001, 9.923999999999999, 9.936, 9.946999999999999, 9.959, 9.970000000000001, 9.981999999999999, 9.994, 10.006] ;
angle = [0, 0, 0, 0, 1, 1, 2, 2, 3, 4, 6, 7, 9, 11, 13, 16, 19, 22, 26, 30, 34, 39, 44, 48, 53, 58, 64, 70, 75, 83, 88, 96, 103, 110, 120, 128, 134, 142, 150, 158, 168, 178, 188, 198, 207, 217, 226, 234, 244, 252, 264, 272, 283, 293, 304, 314, 325, 335, 344, 355, 366, 374, 385, 396, 407, 417, 428, 436, 448, 459, 467, 477, 488, 496, 507, 517, 528, 538, 547, 563, 571, 580, 587, 595, 603, 612, 619, 627, 634, 641, 648, 653, 659, 664, 669, 674, 679, 684, 688, 691, 694, 697, 701, 703, 705, 706, 708, 709, 710, 710, 710, 710, 709, 708, 708, 707, 705, 704, 702, 699, 697, 694, 692, 688, 684, 680, 676, 672, 663, 658, 652, 647, 640, 634, 629, 622, 617, 608, 603, 595, 588, 580, 571, 563, 556, 548, 539, 530, 520, 513, 504, 496, 487, 476, 466, 458, 449, 439, 430, 420, 412, 402, 394, 384, 374, 362, 352, 344, 334, 326, 316, 306, 296, 286, 276, 264, 254, 246, 237, 228, 220, 211, 202, 193, 184, 177, 169, 159, 151, 144, 137, 131, 124, 116, 110, 103, 98, 92, 86, 80, 74, 70, 66, 62, 58, 54, 51, 48, 46, 44, 42, 40, 39, 38, 37, 37, 37, 38, 38, 39, 40, 42, 43, 45, 48, 50, 53, 55, 59, 62, 67, 71, 76, 81, 85, 91, 96, 102, 107, 114, 121, 129, 137, 144, 152, 160, 167, 178, 186, 195, 204, 213, 222, 231, 241, 250, 258, 268, 278, 288, 298, 306, 317, 327, 338, 346, 359, 370, 378, 389, 400, 408, 419, 432, 440, 451, 462, 474, 482, 493, 503, 512, 522, 532, 542, 552, 560, 569, 578, 586, 596, 605, 614, 622, 629, 639, 647, 654, 664, 671, 677, 683, 689, 694, 701, 706, 710, 715, 720, 724, 728, 731, 734, 736, 739, 741, 742, 743, 744, 745, 745, 745, 745, 745, 744, 743, 742, 740, 739, 737, 734, 732, 729, 725, 722, 719, 715, 711, 706, 701, 696, 691, 685, 680, 674, 668, 660, 655, 648, 642, 634, 626, 618, 612, 604, 596, 587, 579, 570, 562, 554, 545, 534, 526, 518, 508, 500, 491, 481, 472, 463, 454, 442, 430, 421, 412, 402, 392, 381, 371, 363, 353, 345, 335, 323, 310, 302, 291, 282, 274, 264, 255, 248, 237, 228, 219, 211, 204, 194, 187, 180, 172, 166, 158, 152, 144, 137, 132, 126, 120, 114, 110, 104, 100, 96, 92, 88, 85, 82, 80, 78, 76, 74, 73, 72, 71, 71, 71, 71, 72, 72, 73, 74, 76, 77, 79, 81, 84, 86, 90, 93, 96, 100, 105, 109, 114, 120, 125, 130, 136, 144, 150, 156, 163, 170, 176, 184, 192, 200, 208, 216, 225, 234, 243, 250, 260, 269, 277, 288, 297, 306, 316, 332, 342, 352, 361, 372, 382, 393, 402, 412, 423, 432, 444, 455, 464, 474, 483, 494, 506, 516, 525, 536, 546, 556, 567, 576, 585, 593, 603, 612, 623, 630, 640, 648, 658, 666, 673, 681, 689, 695, 702, 709, 716, 722, 730, 735, 740, 746, 750, 754, 758, 762, 765, 768, 770, 773, 775, 776, 777, 778, 779, 779, 779, 778, 778, 777, 776, 775, 774, 772, 770, 768, 766, 762, 760, 756, 753, 749, 745, 740, 735, 730, 725, 720, 714, 708, 702, 694, 686, 678, 671, 665, 658, 651, 642, 636, 627, 619, 612, 603, 593, 584, 576, 567, 558, 550, 539, 530, 520, 512, 501, 491, 481, 473, 463, 453, 443, 433, 425, 415, 407, 397, 385, 375, 366, 356, 348, 338, 328, 319, 309, 302, 292, 283, 274, 265, 258, 249, 242, 234, 225, 217, 209, 202, 194, 187, 180, 173, 167, 162, 156, 150, 145, 140, 135, 131, 126, 123, 120, 117, 114, 112, 110, 108, 107, 106, 105, 104, 104, 104, 104, 105, 106, 107, 108, 110, 112, 115, 117, 120, 123, 126, 130, 134, 138, 142, 146, 153, 158, 164, 169, 176, 183, 188, 195, 201, 209, 216, 224, 232, 249, 259, 267, 276, 283, 292, 302, 313, 321, 331, 341, 351, 361, 372, 382, 392, 401, 412, 420, 433, 444, 454, 465, 476, 486, 497, 506, 516, 527, 536, 546, 558, 569, 579, 589, 599, 609, 618, 627, 637, 648, 656, 665, 680, 688, 695, 708, 714, 722, 730, 736, 743, 750, 756, 762, 768, 772, 780, 784, 788, 792, 795, 799, 802, 805, 807, 810, 811, 813, 814, 814, 815, 815, 815, 814, 814, 813, 812, 811, 808, 806, 804, 802, 799, 796, 792, 789, 784, 780, 776, 771, 767, 761, 757, 751, 745, 739, 732, 726, 719, 710, 704, 697, 691, 683, 675, 668, 659, 652, 643, 634, 625, 618, 604, 595, 587, 576, 566, 558, 549, 539, 528, 518, 509, 500, 491, 481, 471, 461, 453, 443, 433, 422, 412, 402, 394, 384, 374, 366, 357, 348, 338, 322, 314, 304, 296, 284, 276, 268, 259, 252, 244, 237, 230, 221, 215, 209, 202, 196, 190, 184, 179, 174, 170, 166, 161, 158, 155, 152, 149, 147, 145, 144] ;
f = 0.4 ;

volta=volta*.001;
%freq(end+1)=f;

dutycycle=sin(2*pi*t*f)*100;
 
vol=volta*dutycycle*0.01;
%% Plots
figure
plot(t,angle)
hold on
plot(t,vol)

figure
plot(t,8*(angle-mean(angle))/mean(angle))
hold on
plot(t,vol)
%% 
%[ol_mag(end+1)]=getMagn(t',vol',angle',f);

load('ol_data.mat');

% semilogx(2*pi*freq,20*log10(ol_mag))